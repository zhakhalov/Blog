@{
    Layout = "~/Views/Shared/Layout.cshtml";
    
    Blog.Repository.Models.ArticleModel article = ViewBag.Article;

    ViewBag.Title = article.Title;

    string disabled = ViewBag.isCommentEnabled ? "" : "disabled";
}

@functions
{
    string GetRating(int rating)
    {
        return (rating > 0 ? "+" : "") + rating.ToString();
    }
}

@section Header{
    <link href="~/Content/Styles/Article/styles.css" rel="stylesheet" type="text/css" />
    <script src="~/bower_components/jquery-autosize/jquery.autosize.js" type="text/javascript"></script>
    <script src="~/Scripts/count-group.js" type="text/javascript"></script>
    <script src="~/bower_components/angular/angular.js"></script>
    <script src="~/Scripts/article.js" type="text/javascript"></script>
}

<div ng-app="app">
    <section class="well article">
        <header class="page-header">
            <h2>@article.Title</h2>
            <div class="pull-right">
                <strong>@article.Author</strong> <small>@article.CreateDate.ToString("MMMM dd, yyyy.", System.Globalization.CultureInfo.CreateSpecificCulture("en-US"))</small>
            </div>
        </header>
        <article>
            @article.Content
        </article>
        <hr />
        <section>
            Tags:
            @foreach (var t in article.Tags)
            {
                <a href="@Url.Action("Tag", "Article", new  { tag = t })" class="label label-default">@t</a>
            }
        </section>
        @*<div class="pull-right">
                <button type="submit" class="btn btn-default btn-sm rate-up" @disabled @rateTooltip><i class="glyphicon glyphicon-chevron-up" style="color:green"></i></button>
                <strong style="color:@ratingColor">@GetRating(article.Rating)</strong>
                <button type="submit" class="btn btn-default btn-sm rate-down" @disabled @rateTooltip><i class="glyphicon glyphicon-chevron-down" style="color:red"></i></button>
            </div>*@
        <hr />
    </section>
    <section class="panel panel-default">
        <header class="panel-heading">
            <h3 class="panel-title">Comments</h3>
        </header>
        <div class="panel-body">
            <div class="well" id="comment">
                <form method="post" class="form-horizontal">
                    <fieldset>
                        <input type="text" class="action" value="@Url.Action("Comment", "Article")" hidden />
                        <input type="text" class="id" value="@article._id.ToString()" hidden />
                        <legend>Add your comment</legend>
                        <div class="form-group">
                            <textarea class="form-control content" placeholder="Comment..." name="Content"></textarea>
                            <label>Remains characters: <span class="count"></span></label>
                        </div>
                        <button type="button" class="btn btn-success btn-comment" @disabled>
                            Add Comment
                        </button>
                    </fieldset>
                </form>
            </div>
            @foreach (var c in article.Comments)
            {
                @Html.Partial("Partial/Comment", c)
            }
        </div>
    </section>
</div>